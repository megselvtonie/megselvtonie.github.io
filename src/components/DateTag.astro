---
const { datetime } = Astro.props;
const d = new Date(datetime);

const now = new Date();

const timeStr = d.toLocaleTimeString("no-NO", { hour: "2-digit", minute: "2-digit" });




function formatLabel() {
  // Sammenlign kun dato (ikke klokkeslett)
  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
  const uploadDay = new Date(d.getFullYear(), d.getMonth(), d.getDate());
  const diffMs = today.getTime() - uploadDay.getTime();
  const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));

  const diffMonths =
    (now.getFullYear() - d.getFullYear()) * 12 + (now.getMonth() - d.getMonth());
  const diffYears = now.getFullYear() - d.getFullYear();

  if (diffDays === 0) return `skrevet i dag kl. ${timeStr}`;
  if (diffDays === 1) return `satt opp i g책r kl. ${timeStr}`;
  if (diffDays === 2) return `satt opp i forg책rs kl. ${timeStr}`;
  if (diffDays < 7) {
    const weekday = d.toLocaleDateString("no-NO", { weekday: "long" });
    return `lagt ut ${weekday} kl. ${timeStr}`;
  }
  if (diffDays === 14) return `for ${diffDays} dager siden kl. ${timeStr}`;
  if (diffDays < 31) {
    const weekday = d.toLocaleDateString("no-NO", { weekday: "long" });
    const monthDay = d.toLocaleDateString("no-NO", { day: "2-digit", month: "long" });
    return `${weekday} ${monthDay} kl. ${timeStr}`;
  }
    if (diffDays < 364) {
    const weekday = d.toLocaleDateString("no-NO", { weekday: "long" });
    const monthDay = d.toLocaleDateString("no-NO", { day: "2-digit", month: "long" });
    return `${weekday} ${monthDay} kl. ${timeStr}`;
  }
  if (diffMonths === 1) return "for 1 m책ned siden";
  if (diffMonths < 12) return `for ${diffMonths} m책neder siden`;
  if (diffYears === 1) return "i fjor";
  return `${d.toLocaleDateString("no-NO", { day: "2-digit", month: "2-digit", year: "numeric" })} kl. ${timeStr}`;
}

const label = formatLabel();
---

<span class="date-tag">{label}</span>

<style>
  .date-tag {
    display: inline-block;
    color: #555;
    font-size: 0.65rem;
    font-weight: 500;
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-family: system-ui, sans-serif;
  }
</style>
